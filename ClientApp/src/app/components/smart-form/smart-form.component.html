<div class="smart-form-container">
  <!-- Header -->
  <div class="form-header">
    <h1>ü§ñ Smart Form Filler</h1>
    <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏î‡πâ‡∏ß‡∏¢ AI - ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</p>
  </div>

  <!-- Progress Steps -->
  <div class="progress-steps">
    <div class="step" [class.active]="currentStep() >= 1" [class.completed]="currentStep() > 1">
      <div class="step-number">1</div>
      <span>‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</span>
    </div>
    <div class="step-line" [class.active]="currentStep() > 1"></div>
    <div class="step" [class.active]="currentStep() >= 2" [class.completed]="currentStep() > 2">
      <div class="step-number">2</div>
      <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</span>
    </div>
    <div class="step-line" [class.active]="currentStep() > 2"></div>
    <div class="step" [class.active]="currentStep() >= 3">
      <div class="step-number">3</div>
      <span>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</span>
    </div>
  </div>

  <!-- Step 1: Upload -->
  @if (currentStep() === 1) {
    <div class="step-content">
      <div class="upload-section">
        <!-- Upload Header -->
        <div class="upload-header">
          <h2>üìÑ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</h2>
          <p>‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 3 ‡∏£‡∏π‡∏õ ‡πÄ‡∏ä‡πà‡∏ô ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô, ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á, ‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà</p>
        </div>

        <!-- Image Gallery -->
        <div class="images-gallery">
          @for (img of selectedImages(); track img.id) {
            <div class="image-card">
              <div class="image-wrapper">
                <img [src]="img.image" [alt]="img.name">
                <button class="btn-remove" (click)="removeImage(img.id)" title="‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ">‚úï</button>
              </div>
              <div class="image-info">
                <span class="image-type">
                  @switch (img.type) {
                    @case ('id_card') { ü™™ ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô }
                    @case ('passport') { üìï ‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á }
                    @case ('driver_license') { üöó ‡πÉ‡∏ö‡∏Ç‡∏±‡∏ö‡∏Ç‡∏µ‡πà }
                    @default { üìÑ {{ img.name }} }
                  }
                </span>
              </div>
            </div>
          }

          <!-- Add more images slot -->
          @if (selectedImages().length < 3) {
            <div class="image-card add-card">
              <div class="add-placeholder" (click)="addFileInput.click()">
                <span class="add-icon">‚ûï</span>
                <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ</span>
              </div>
              <input #addFileInput type="file" accept="image/*" (change)="onFileSelected($event)" hidden>
            </div>
          }
        </div>

        <!-- Upload Actions -->
        @if (selectedImages().length === 0) {
          <div class="upload-area">
            <div class="upload-placeholder">
              <span class="upload-icon">üì§</span>
              <h3>‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h3>
              <p>‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</p>
              <p class="file-hint">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: JPG, PNG, WEBP (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ)</p>
              <div class="upload-actions">
                <button class="btn-upload" (click)="fileInput.click()">
                  <span>üìÅ</span> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
                </button>
                <button class="btn-sample" (click)="useSampleImages()">
                  <span>üé≠</span> ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á 3 ‡∏£‡∏π‡∏õ
                </button>
              </div>
              <input #fileInput type="file" accept="image/*" (change)="onFileSelected($event)" hidden>
            </div>
          </div>
        }

        <!-- AI Analysis Section -->
        @if (selectedImages().length > 0) {
          <div class="ai-section">
            <div class="selected-files-summary">
              <span class="files-count">üìé ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß {{ selectedImages().length }} ‡∏£‡∏π‡∏õ</span>
            </div>
            
            @if (!isProcessing() && !isFormFilled()) {
              <button class="btn-analyze" (click)="processImages()">
                <span class="ai-icon">ü§ñ</span>
                ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢ AI
              </button>
              <p class="analyze-hint">AI ‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</p>
            }

            @if (isProcessing()) {
              <div class="processing-status">
                <div class="spinner"></div>
                <span>{{ processingStep() }}</span>
              </div>
            }

            @if (isFormFilled()) {
              <div class="success-message">
                <span class="success-icon">‚úÖ</span>
                <span>AI ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å {{ selectedImages().length }} ‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!</span>
              </div>
              <button class="btn-next" (click)="nextStep()">
                ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ <span>‚Üí</span>
              </button>
            }
          </div>
        }
      </div>

      <!-- Features -->
      <div class="features-grid">
        <div class="feature-card">
          <span class="feature-icon">‚ö°</span>
          <h4>‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß</h4>
          <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</p>
        </div>
        <div class="feature-card">
          <span class="feature-icon">üéØ</span>
          <h4>‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</h4>
          <p>AI ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 99%</p>
        </div>
        <div class="feature-card">
          <span class="feature-icon">üîí</span>
          <h4>‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h4>
          <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô</p>
        </div>
      </div>
    </div>
  }

  <!-- Step 2: Personal Information -->
  @if (currentStep() === 2) {
    <div class="step-content">
      <div class="form-section">
        <h2>üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h2>
        
        <div class="form-grid">
          <!-- Title & Name -->
          <div class="form-group">
            <label>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
            <select [ngModel]="formData().titleName" (ngModelChange)="updateField('titleName', $event)">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
              @for (title of titleOptions; track title) {
                <option [value]="title">{{ title }}</option>
              }
            </select>
          </div>
          
          <div class="form-group">
            <label>‡∏ä‡∏∑‡πà‡∏≠ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</label>
            <input type="text" [ngModel]="formData().firstName" 
                   (ngModelChange)="updateField('firstName', $event)"
                   [class.filled]="formData().firstName">
          </div>
          
          <div class="form-group">
            <label>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</label>
            <input type="text" [ngModel]="formData().lastName"
                   (ngModelChange)="updateField('lastName', $event)"
                   [class.filled]="formData().lastName">
          </div>

          <div class="form-group">
            <label>First Name (English)</label>
            <input type="text" [ngModel]="formData().firstNameEn"
                   (ngModelChange)="updateField('firstNameEn', $event)"
                   [class.filled]="formData().firstNameEn">
          </div>
          
          <div class="form-group">
            <label>Last Name (English)</label>
            <input type="text" [ngModel]="formData().lastNameEn"
                   (ngModelChange)="updateField('lastNameEn', $event)"
                   [class.filled]="formData().lastNameEn">
          </div>

          <div class="form-group">
            <label>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
            <input type="text" [ngModel]="formData().idCard"
                   (ngModelChange)="updateField('idCard', $event)"
                   [class.filled]="formData().idCard"
                   placeholder="x-xxxx-xxxxx-xx-x">
          </div>

          <div class="form-group">
            <label>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
            <input type="date" [ngModel]="formData().birthDate"
                   (ngModelChange)="updateField('birthDate', $event)"
                   [class.filled]="formData().birthDate">
          </div>

          <div class="form-group">
            <label>‡∏™‡∏±‡∏ç‡∏ä‡∏≤‡∏ï‡∏¥</label>
            <input type="text" [ngModel]="formData().nationality"
                   (ngModelChange)="updateField('nationality', $event)"
                   [class.filled]="formData().nationality">
          </div>
        </div>

        <h3>üìû ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h3>
        <div class="form-grid">
          <div class="form-group">
            <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
            <input type="tel" [ngModel]="formData().phone"
                   (ngModelChange)="updateField('phone', $event)"
                   [class.filled]="formData().phone"
                   placeholder="0xx-xxx-xxxx">
          </div>
          
          <div class="form-group">
            <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input type="email" [ngModel]="formData().email"
                   (ngModelChange)="updateField('email', $event)"
                   [class.filled]="formData().email"
                   placeholder="example@email.com">
          </div>
        </div>

        <h3>üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</h3>
        <div class="form-grid">
          <div class="form-group full-width">
            <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
            <input type="text" [ngModel]="formData().address"
                   (ngModelChange)="updateField('address', $event)"
                   [class.filled]="formData().address"
                   placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ‡∏´‡∏°‡∏π‡πà ‡∏ã‡∏≠‡∏¢ ‡∏ñ‡∏ô‡∏ô">
          </div>
          
          <div class="form-group">
            <label>‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•</label>
            <input type="text" [ngModel]="formData().subDistrict"
                   (ngModelChange)="updateField('subDistrict', $event)"
                   [class.filled]="formData().subDistrict">
          </div>
          
          <div class="form-group">
            <label>‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
            <input type="text" [ngModel]="formData().district"
                   (ngModelChange)="updateField('district', $event)"
                   [class.filled]="formData().district">
          </div>
          
          <div class="form-group">
            <label>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
            <select [ngModel]="formData().province" (ngModelChange)="updateField('province', $event)">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î --</option>
              @for (province of provinces; track province) {
                <option [value]="province">{{ province }}</option>
              }
            </select>
          </div>
          
          <div class="form-group">
            <label>‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
            <input type="text" [ngModel]="formData().postalCode"
                   (ngModelChange)="updateField('postalCode', $event)"
                   [class.filled]="formData().postalCode"
                   placeholder="xxxxx">
          </div>
        </div>

        <div class="form-actions">
          <button class="btn-back" (click)="prevStep()">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button class="btn-next" (click)="nextStep()">
            ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <span>‚Üí</span>
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Step 3: Business Information -->
  @if (currentStep() === 3) {
    <div class="step-content">
      <div class="form-section">
        <h2>üè¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</h2>
        
        <div class="form-grid">
          <div class="form-group full-width">
            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£</label>
            <input type="text" [ngModel]="formData().companyName"
                   (ngModelChange)="updateField('companyName', $event)"
                   [class.filled]="formData().companyName"
                   placeholder="‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ... ‡∏à‡∏≥‡∏Å‡∏±‡∏î">
          </div>
          
          <div class="form-group">
            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</label>
            <select [ngModel]="formData().businessType" (ngModelChange)="updateField('businessType', $event)">
              <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
              @for (type of businessTypes; track type) {
                <option [value]="type">{{ type }}</option>
              }
            </select>
          </div>
          
          <div class="form-group">
            <label>‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ï‡πà‡∏≠‡∏õ‡∏µ (‡∏ö‡∏≤‡∏ó)</label>
            <input type="text" [ngModel]="formData().annualRevenue"
                   (ngModelChange)="updateField('annualRevenue', $event)"
                   [class.filled]="formData().annualRevenue"
                   placeholder="‡πÄ‡∏ä‡πà‡∏ô 10,000,000">
          </div>
          
          <div class="form-group full-width">
            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</label>
            <input type="text" [ngModel]="formData().exportCountries"
                   (ngModelChange)="updateField('exportCountries', $event)"
                   [class.filled]="formData().exportCountries"
                   placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏µ‡∏ô, ‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô, ‡∏™‡∏´‡∏£‡∏±‡∏ê‡∏≠‡πÄ‡∏°‡∏£‡∏¥‡∏Å‡∏≤">
          </div>
        </div>

        <!-- Terms -->
        <div class="terms-section">
          <label class="checkbox-label">
            <input type="checkbox">
            <span>‡∏Ç‡πâ‡∏≤‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö<a href="#">‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</a>‡πÅ‡∏•‡∏∞<a href="#">‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</a></span>
          </label>
        </div>

        <div class="form-actions">
          <button class="btn-back" (click)="prevStep()">
            <span>‚Üê</span> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
          </button>
          <button class="btn-submit" (click)="submitForm()">
            <span>‚úì</span> ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
          </button>
        </div>
      </div>

      <!-- Summary Card -->
      <div class="summary-card">
        <h3>üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
        <div class="summary-item">
          <span class="label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</span>
          <span class="value">{{ formData().titleName }} {{ formData().firstName }} {{ formData().lastName }}</span>
        </div>
        <div class="summary-item">
          <span class="label">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô:</span>
          <span class="value">{{ formData().idCard }}</span>
        </div>
        <div class="summary-item">
          <span class="label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•:</span>
          <span class="value">{{ formData().email }}</span>
        </div>
        <div class="summary-item">
          <span class="label">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:</span>
          <span class="value">{{ formData().companyName }}</span>
        </div>
      </div>
    </div>
  }
</div>
