<div class="upload-container">
  <h2>üìÑ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
  
  <div class="drop-zone" 
       (dragover)="onDragOver($event)" 
       (drop)="onDrop($event)"
       [class.has-files]="selectedFiles.length > 0">
    <div class="drop-content">
      <span class="icon">üìÑ</span>
      <p>‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡∏´‡∏£‡∏∑‡∏≠</p>
      <label class="file-input-label">
        ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
        <input type="file" multiple (change)="onFileSelected($event)" accept=".txt,.md,.json,.csv,.pdf,.doc,.docx">
      </label>
      <small>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå .txt, .md, .json, .csv, .pdf, .doc, .docx</small>
    </div>
  </div>

  @if (selectedFiles.length > 0) {
    <div class="selected-files">
      <h4>‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ({{ selectedFiles.length }} ‡πÑ‡∏ü‡∏•‡πå)</h4>
      <ul>
        @for (file of selectedFiles; track file.name; let i = $index) {
          <li>
            <span class="file-name">{{ file.name }}</span>
            <span class="file-size">{{ file.size | fileSize }}</span>
            <button class="remove-btn" (click)="removeFile(i)">‚úï</button>
          </li>
        }
      </ul>
    </div>
  }

  <button class="upload-btn" 
          (click)="upload()" 
          [disabled]="isUploading || selectedFiles.length === 0">
    @if (isUploading) {
      <span class="spinner"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...
    } @else {
      ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
    }
  </button>

  @if (message) {
    <div class="message" [class.success]="messageType === 'success'" [class.error]="messageType === 'error'">
      {{ message }}
    </div>
  }

  @if (uploadedDocs.length > 0) {
    <div class="uploaded-section">
      <h3>üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î</h3>
      
      <!-- Summary Type Selector -->
      <div class="summary-options">
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ:</label>
        <select [(ngModel)]="selectedSummaryType">
          @for (type of summaryTypes; track type.value) {
            <option [value]="type.value">{{ type.icon }} {{ type.label }}</option>
          }
        </select>
      </div>

      <div class="documents-grid">
        @for (doc of uploadedDocs; track trackByDocId) {
          <div class="document-card">
            <div class="doc-header">
              <span class="doc-icon">üìÑ</span>
              <div class="doc-info">
                <h4>{{ doc.title || doc.fileName }}</h4>
                <small>{{ doc.fileName }} ‚Ä¢ {{ doc.size | fileSize }}</small>
              </div>
              <button class="delete-btn" (click)="deleteDocument(doc)" title="‡∏•‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£">üóëÔ∏è</button>
            </div>

            <div class="doc-actions">
              <button class="summarize-btn" 
                      (click)="summarizeDocument(doc)" 
                      [disabled]="isSummarizing[doc.id]">
                @if (isSummarizing[doc.id]) {
                  <span class="spinner"></span> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡∏∏‡∏õ...
                } @else {
                  ü§ñ ‡∏™‡∏£‡∏∏‡∏õ‡∏î‡πâ‡∏ß‡∏¢ AI
                }
              </button>
            </div>

            @if (summaryResults[doc.id]) {
              <div class="summary-result">
                <div class="summary-header">
                  <h5>‚ú® {{ getSummaryTypeLabel(summaryResults[doc.id].summaryType) }}</h5>
                  <button class="close-summary" (click)="clearSummary(doc.id)">‚úï</button>
                </div>
                <div class="summary-content">
                  {{ summaryResults[doc.id].summary }}
                </div>
              </div>
            }
          </div>
        }
      </div>
    </div>
  }
</div>
